<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>   

    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
</head>

<body>
    <video id="video" autoplay></video>
    <canvas id="canvas" style="display: none;"></canvas>

    <script>
        const videoElement = document.getElementById("video");
        const canvasElement = document.getElementById("canvas");
        const canvasContext = canvasElement.getContext("2d");
        
        // Function to start the camera and QR code detection
        async function startCamera() {
              try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                videoElement.srcObject = stream;
            
                // Wait for the video to start and get its dimensions
                videoElement.onloadedmetadata = () => {
                  canvasElement.width = videoElement.videoWidth;
                  canvasElement.height = videoElement.videoHeight;
                  setInterval(detectQRCode, 100); // Call detectQRCode every 100ms
                };
              } catch (error) {
                console.error("Error accessing the camera:", error);
              }
        }
        
        // Function to detect QR codes
        function detectQRCode() {
              canvasContext.drawImage(videoElement, 0, 0, canvasElement.width, canvasElement.height);
              const imageData = canvasContext.getImageData(0, 0, canvasElement.width, canvasElement.height);
              const code = jsQR(imageData.data, imageData.width, imageData.height);
            
              if (code) {
                console.log("QR code detected:", code.data);
                // You can handle the detected QR code here
              }
        }
        
        // Start the camera when the page loads
        window.onload = startCamera;
    </script>
</body>

</html>
